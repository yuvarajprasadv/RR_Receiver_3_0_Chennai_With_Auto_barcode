var order = "1-3-2-4";var eachOrder = order.split("-");var counter = 0;var doc = app.activeDocument;main(arguments);function getVisible(txObj){    var result=0;    for (var i=0;i<txObj.lines.length;i++)    {        result += txObj.lines[i].characters.length;    }    return result;} function getChars(txObj){    var result=0;    for (var i=0;i<txObj.paragraphs.length;i++)    {        result += txObj.paragraphs[i].characters.length;    }    return result;} function scalingWidth(txObj, wscl, orderSeq){    for (var i=0;i<txObj.paragraphs.length;i++)    {         switch (orderSeq)         {              case "1":              {	              txObj.paragraphs[i].characterAttributes.tracking -= 1;	              redraw();              }              case "2":              {                    txObj.paragraphs[i].characterAttributes.size -= 0.5;                    redraw();              }              case "3":              {	              txObj.paragraphs[i].characterAttributes.tracking -= 1;	              redraw();              }              case "4":              {                    txObj.paragraphs[i].characterAttributes.leading  -= 0.5;                    redraw();              }               }    }}  function getCharacters(eachTextFrame, eachOrder){    var ordSeq = 0;    slct =eachTextFrame;    cntsLength = getChars(slct);    visibleChar =getVisible(slct);    var vscale = 1.0;    stepNum = 0.02;     while (cntsLength != visibleChar)     {        if (ordSeq == 4)        {            ordSeq = 0;        }        scalingWidth(slct, [vscale, 1], eachOrder[ordSeq++]);        visibleChar = getVisible(slct);        vscale = vscale-stepNum;    } }function ApplyStyleInOrder(eachTextFrame, eachOrder){        getCharacters(eachTextFrame, eachOrder);}function GetArrtributes( elmtAttr){    var eachAttribute = new Array;    eachAttribute = elmtAttr.split(",");    return eachAttribute;}function main(arg){        if(arg[0]=="0")        {             if ( app.documents.length > 0 )             {                doc = app.activeDocument;                paragraphCount = 0;                var artItem = doc.textFrames;                var artItemArr = new Array;                var artInc = 0;                for ( i =0; i <artItem.length; i++ )                 {					if(artItem[i].name.split ("::", 1)  == "Typhoon Plug-In Object" )					{						artItemArr[artInc] = artItem[i].name + "~" + i;						artInc++;					}                }                return (artItemArr);             }        }         else if (arg[0]=="1")        {            var elmAttr = new Array;            elmAttr = arg[2];            var elementAttr = new Array;                        if ( elementAttr != "null" )             {                doc = app.activeDocument;                var artItem = doc.textFrames;                var artItemArr = new Array;                var artInc = 0;                var index = (arg[3].split("~"));                if (artItem[index[1]].name == index[0])                {                     	textArtRange = artItem[index[1]];					ApplyStyleInOrder(textArtRange, eachOrder);                }                return "True";             }             else            {                return "False";            }      }}