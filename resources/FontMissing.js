main (); var doclist = app.textFonts;var appFontList = new Array ();var docFontsList = GetFontsOfDoc(activeDocument);for (i=0;i< app.textFonts.length; i++){    var fontName = app.textFonts[i].name;    appFontList[i] = fontName;} function GetFontsOfDoc(doc){     var xmlString = new XML(doc.XMPString);     fontsInfo = xmlString.descendants("stFnt:fontName");     var ln = fontsInfo.length(), arr = [];     for (var i = 0; i<ln; i++)     {         arr.push(fontsInfo[i]);      }  //  $.writeln("\n di "+ arr);     return arr;} function CheckFonts(){    var fontArray = new Array ();    for (i=0; i < docFontsList.length; i++)    {        var thisDocFont = docFontsList[i];        var activeFont = false;        for (j = 0; j < appFontList.length; j++)        {            var thisAppFont = appFontList[j];            if (i==0)            // $.writeln (thisAppFont);            if (thisDocFont == thisAppFont)            {                activeFont = true;             }         }         if (activeFont == false)         {            fontArray.push (thisDocFont);          }    }    return fontArray;} function main() {     var missingFontsList =  CheckFonts(); //    return (missingFontsList.valueOf()); }